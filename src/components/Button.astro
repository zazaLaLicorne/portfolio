---
interface Props {
  variant?: "default" | "retour" | "validez" | "supprimer" | "gradient";
  type?: "button" | "submit" | "reset";
  href?: string; // si présent, rend le bouton comme un <a>
  class?: string;
  // On autorise toutes les autres props HTML
  [key: string]: any;
}

const {
  variant = "default",
  type = "button",
  class: extra = "",
  href,
  ...rest
} = Astro.props;

const base =
  "px-4 py-2 rounded-md transition text-grey-900 transform hover:-translate-y-0.5 duration-200 dark:hover:text-gray-800";

const variants: Record<string, string> = {
  default:
    "bg-primaryLight dark:bg-primaryDark hover:bg-secondaryLight dark:hover:bg-primaryLight",
  retour:
    "bg-gray-400 dark:bg-gray-600 hover:bg-gray-500 dark:hover:bg-gray-500",
  validez:
    "bg-green-500 dark:bg-green-600 hover:bg-green-600 dark:hover:bg-green-500",
  supprimer:
    "bg-red-500 dark:bg-red-600 hover:bg-red-600 dark:hover:bg-red-500",
  gradient: "animated-gradient hover:opacity-90",
};

const classes = `${base} ${variants[variant]} ${extra}`;
---

{
  href ? (
    <a href={href} class={classes} {...rest}>
      <slot />
    </a>
  ) : (
    <button type={type} class={classes} {...rest}>
      <slot />
    </button>
  )
}

<style>
  @keyframes gradientShift {
    0% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
    100% {
      background-position: 0% 50%;
    }
  }

  .animated-gradient {
    background: linear-gradient(
      90deg,
      var(--accent-dark),
      var(--accent-light),
      var(--bg-tertiary-dark),
      var(--accent)
    );
    background-size: 300% 300%;
    animation: gradientShift 6s ease infinite;
    color: var(--text);
    border: none;
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
    transition:
      transform 0.3s ease,
      box-shadow 0.3s ease,
      opacity 0.3s ease,
      filter 0.4s ease;
  }

  /* Effet hover sur le bouton */
  .animated-gradient:hover {
    animation: gradientReverse 6s ease infinite;
    transform: translateY(-4px) scale(1.03);
    filter: brightness(1.25) saturate(1.3);
    box-shadow:
      0 8px 20px rgba(0, 0, 0, 0.25),
      0 0 12px var(--accent-light),
      0 0 24px var(--accent);
  }

  /* Empêche la ligne animée sous tous les boutons rendus comme <a> */
  a[class*="bg-"],
  a[class*="animated-gradient"],
  a[class*="btn"],
  a[class*="button"],
  a[class*="retour"],
  a[class*="validez"],
  a[class*="supprimer"] {
    position: relative;
    text-decoration: none;
  }

  a[class*="bg-"]::after,
  a[class*="animated-gradient"]::after,
  a[class*="btn"]::after,
  a[class*="button"]::after,
  a[class*="retour"]::after,
  a[class*="validez"]::after,
  a[class*="supprimer"]::after {
    display: none !important;
    content: none !important;
  }
</style>
